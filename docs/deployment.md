# Развертывание

## 1. Окружения

### 1.1. Development
- Локальное окружение разработчиков
- Docker контейнеры для сервисов
- Мок API для тестирования

### 1.2. Testing
- Автоматическое развертывание из develop
- Полный набор тестовых данных
- Интеграция с тестовым API WB

### 1.3. Staging
- Копия production окружения
- Реальные данные (анонимизированные)
- Тестирование производительности

### 1.4. Production
- Высокая доступность
- Балансировка нагрузки
- Резервное копирование

## 2. Инфраструктура

### 2.1. Серверы
- Application servers (4+ CPU, 8+ GB RAM)
- Database servers (8+ CPU, 16+ GB RAM)
- Cache servers (4+ CPU, 8+ GB RAM)
- Load balancers (2+ CPU, 4+ GB RAM)

### 2.2. Сеть
- HTTPS (443 порт)
- VPN для админ доступа
- Внутренняя сеть для сервисов
- CDN для статики

### 2.3. Мониторинг
- Prometheus + Grafana
- ELK Stack для логов
- Алерты в Telegram
- Метрики приложения

## 3. Процесс развертывания

### 3.1. Подготовка
```bash
# Клонирование репозитория
git clone https://github.com/company/wb-assistant.git
cd wb-assistant

# Установка зависимостей
npm install

# Сборка проекта
npm run build
```

### 3.2. Конфигурация
```bash
# Настройка переменных окружения
cp .env.example .env
vim .env

# Настройка Docker
cp docker-compose.yml.example docker-compose.yml
vim docker-compose.yml
```

### 3.3. Развертывание
```bash
# Запуск Docker контейнеров
docker-compose up -d

# Миграции базы данных
npm run migrate:up

# Проверка статуса
docker-compose ps
```

## 4. Резервное копирование

### 4.1. База данных
- Ежедневные полные бэкапы
- Инкрементальные бэкапы каждые 6 часов
- Хранение бэкапов 30 дней
- Тестирование восстановления

### 4.2. Файлы
- Резервное копирование статики
- Бэкап конфигураций
- Архивирование логов
- Внешнее хранилище

### 4.3. Мониторинг бэкапов
- Проверка целостности
- Уведомления об ошибках
- Автоматическое тестирование
- Отчеты о состоянии

## 5. Безопасность

### 5.1. Сетевая безопасность
- Файрвол (iptables)
- WAF (ModSecurity)
- DDoS защита
- SSL/TLS настройка

### 5.2. Доступ
- SSH ключи
- Двухфакторная аутентификация
- RBAC для админов
- Аудит действий

### 5.3. Мониторинг безопасности
- IDS/IPS
- Сканирование уязвимостей
- Мониторинг логов
- Реагирование на инциденты 