# API Эндпоинты

## Обзор

Данный документ содержит полное описание всех API эндпоинтов, предоставляемых сервером для мобильного и веб-клиентов приложения Wildberries Assistant.

## Структура API

Все API эндпоинты сгруппированы по функциональным модулям:

- Аутентификация (`/auth`)
- Заказы (`/api/orders`)
- Поставки (`/api/supplies`)
- Смены (`/shifts`)
- Инвентаризация (`/inventory`)
- Склад (`/warehouse`)
- Wildberries API (`/api/wb`)
- Печать (`/api/printer`)
- Запросы (`/api/requests`)
- Метрики (`/api/metrics`)
- Настройки (`/api/settings`)
- Предприятия (`/api/enterprise`)
- Пользователи (`/api/users`)

## Аутентификация

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/auth/login` | POST | Авторизация пользователя | `username`, `password` | JWT токен, данные пользователя |
| `/auth/logout` | POST | Выход из системы | - | Статус операции |
| `/auth/refresh` | POST | Обновление токена | `refreshToken` | Новый JWT токен |

## Заказы (Orders)

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/api/orders` | GET | Получение списка заказов | `enterpriseId` (query) | Массив заказов |
| `/api/orders/:id` | GET | Получение заказа по ID | `id` (path) | Объект заказа |
| `/api/orders/number` | GET | Получение заказа по номеру | `number` (query) | Объект заказа |
| `/api/orders/statuses` | GET | Получение статусов заказов | - | Массив статусов |
| `/api/orders/sources` | GET | Получение источников заказов | - | Массив источников |
| `/api/orders/:id/items` | GET | Получение элементов заказа | `id` (path) | Массив элементов |
| `/api/orders/:id/history` | GET | Получение истории заказа | `id` (path) | История заказа |
| `/api/orders` | POST | Создание нового заказа | Объект заказа | Созданный заказ |
| `/api/orders/:id/items` | POST | Добавление элемента в заказ | `id` (path), объект элемента | Обновленный заказ |
| `/api/orders/:id/status` | PATCH | Обновление статуса заказа | `id` (path), `status` | Обновленный заказ |
| `/api/orders/:id/cancel` | POST | Отмена заказа | `id` (path), `reason` | Отмененный заказ |
| `/api/orders/:id` | PUT | Обновление заказа | `id` (path), объект заказа | Обновленный заказ |
| `/api/orders/:id/items/:itemId` | PUT | Обновление элемента заказа | `id`, `itemId`, объект элемента | Обновленный элемент |
| `/api/orders/:id/items/:itemId` | DELETE | Удаление элемента заказа | `id`, `itemId` | Статус операции |
| `/api/orders/:id/scan` | POST | Сканирование штрих-кода | `id` (path), `barcode` | Результат сканирования |
| `/api/orders/:id/impossible` | PUT | Пометить как невозможный к сборке | `id` (path), `reason` | Обновленный заказ |
| `/api/orders/:id/fulfill` | PUT | Списать невозможный заказ | `id` (path) | Обновленный заказ |

## Поставки (Supplies)

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/api/supplies` | GET | Получение списка поставок | `active`, `today`, `tomorrow`, `overdue` (query) | Массив поставок |
| `/api/supplies/:id` | GET | Получение деталей поставки | `id` (path) | Объект поставки |
| `/api/supplies` | POST | Создание новой поставки | Объект поставки | Созданная поставка |
| `/api/supplies/:id` | PUT | Обновление поставки | `id` (path), объект поставки | Обновленная поставка |
| `/api/supplies/:id/status` | PATCH | Обновление статуса поставки | `id` (path), `status` | Обновленная поставка |
| `/api/supplies/:id/assign` | PATCH | Назначение сборщика | `id` (path), `assignedTo` | Обновленная поставка |
| `/api/supplies/:id/orders` | POST | Добавление заказа в поставку | `id` (path), `orderId` | Обновленная поставка |
| `/api/supplies/:id/orders/:orderId` | DELETE | Удаление заказа из поставки | `id`, `orderId` | Обновленная поставка |
| `/api/supplies/:id/orders/:orderId/scan` | POST | Сканирование для поставки | `id`, `orderId`, `barcode` | Результат сканирования |

## Смены (Shifts)

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/shifts` | GET | Получение списка смен | `userId` (query) | Массив смен |
| `/shifts/start` | POST | Начало смены | Объект новой смены | Созданная смена |
| `/shifts/end` | POST | Окончание смены | Объект завершенной смены | Обновленная смена |
| `/shifts/:id` | PUT | Обновление данных смены | `id` (path), объект смены | Обновленная смена |

## Инвентаризация (Inventory)

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/inventory/sessions` | GET | Получение сессий инвентаризации | `status` (query) | Массив сессий |
| `/inventory/sessions/:sessionId` | GET | Получение сессии по ID | `sessionId` (path) | Объект сессии |
| `/inventory/sessions/:sessionId/start` | POST | Начало сессии инвентаризации | `sessionId` (path) | Обновленная сессия |
| `/inventory/sessions/:sessionId/complete` | POST | Завершение сессии инвентаризации | `sessionId` (path) | Обновленная сессия |
| `/inventory/items` | GET | Получение товаров инвентаризации | `sessionId` (query) | Массив товаров |
| `/inventory/items/:itemId` | PUT | Обновление товара инвентаризации | `itemId` (path), объект товара | Обновленный товар |

## Склад (Warehouse)

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/warehouse/cells` | GET | Получение ячеек склада | `section` (query) | Массив ячеек |
| `/warehouse/sections` | GET | Получение секций склада | - | Массив секций |
| `/warehouse/items/location` | GET | Получение местоположения товаров | `barcode` (query) | Местоположение товара |
| `/warehouse/inventory/initiate` | POST | Инициализация инвентаризации | `sections`, `cells` | Созданная сессия |

## Wildberries API

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/api/wb` | GET | Базовый маршрут API Wildberries | - | Статус API |
| `/api/wb/orders/new` | GET | Получение новых заказов | - | Массив новых заказов |
| `/api/wb/orders/stickers` | POST | Получение этикеток | `orderIds`, `type` | Массив этикеток |
| `/api/wb/supplies/create` | POST | Создание поставки WB | `name` | Созданная поставка |
| `/api/wb/supplies/:id/info` | GET | Информация о поставке WB | `id` (path) | Объект поставки |
| `/api/wb/supplies/:id/orders` | POST | Добавление заказов в поставку WB | `id` (path), `orderIds` | Обновленная поставка |

## Печать

| Эндпоинт | Метод | Описание | Параметры | Возвращаемые данные |
|----------|-------|----------|-----------|-------------------|
| `/api/printer/status` | GET | Статус печати | - | Статус принтера |
| `/api/printer/print` | POST | Печать документа | `document`, `type` | Статус печати |
| `/api/printer/labels` | POST | Печать этикеток | `labelIds`, `type` | Статус печати |

## Дополнительные эндпоинты

| Эндпоинт | Метод | Описание | Возвращаемые данные |
|----------|-------|----------|-------------------|
| `/api/health` | GET | Проверка состояния системы | Статус сервера |
| `/api/metrics` | GET | Получение метрик системы | Метрики системы |
| `/api/settings` | GET | Получение настроек | Настройки системы |
| `/api/enterprise` | GET | Список предприятий | Массив предприятий |
| `/api/users` | GET | Список пользователей | Массив пользователей |
| `/api/requests` | GET | Список запросов | Массив запросов |

## Использование в разных клиентах

### Мобильный клиент

Мобильный клиент использует следующие группы эндпоинтов:
- Аутентификация
- Заказы
- Поставки
- Смены
- Инвентаризация
- Склад
- Печать (базовая функциональность)

### Веб-клиент

Веб-клиент использует все доступные эндпоинты, с расширенным функционалом по:
- Администрированию
- Аналитике
- Управлению предприятиями
- Управлению пользователями
- Настройке системы 